# 项目心得功能部署说明

## 📋 功能概述

项目心得功能允许用户记录项目执行过程中的心得体会、技术收获和执行总结。

## 🗂️ 新增文件

### 后端文件

1. **数据库表**
   - `backed/src/main/resources/db/km_project_insight.sql`

2. **实体类**
   - `backed/src/main/java/com/knowledge/entity/ProjectInsight.java`

3. **数据访问层**
   - `backed/src/main/java/com/knowledge/mapper/ProjectInsightMapper.java`
   - `backed/src/main/resources/mapper/ProjectInsightMapper.xml`

4. **服务层**
   - `backed/src/main/java/com/knowledge/service/ProjectInsightService.java`

5. **控制器**
   - `backed/src/main/java/com/knowledge/controller/ProjectInsightController.java`

### 前端文件

- 已修改 `fronted/src/views/daily/ProjectRecord.vue`

## 🚀 部署步骤

### 1. 创建数据库表

在MySQL中执行SQL脚本：

```bash
mysql -u root -p knowledge_management < backed/src/main/resources/db/km_project_insight.sql
```

或者在MySQL客户端中执行：

```sql
source backed/src/main/resources/db/km_project_insight.sql;
```

### 2. 重新编译后端

```bash
cd backed
mvn clean package
```

### 3. 重启后端服务

重启Spring Boot应用：

```bash
java -jar target/knowledge-management-0.0.1-SNAPSHOT.jar
```

或使用IDE重启应用。

### 4. 前端无需额外操作

前端代码已自动更新，刷新浏览器即可。

## 📊 数据库表结构

### km_project_insight（项目心得表）

| 字段名 | 类型 | 说明 |
|-------|------|------|
| id | BIGINT | 主键ID |
| project_id | BIGINT | 关联项目ID |
| title | VARCHAR(200) | 心得标题 |
| summary | VARCHAR(500) | 心得摘要 |
| content | TEXT | 心得内容（富文本HTML） |
| tags | VARCHAR(500) | 标签，多个标签用逗号分隔 |
| rec_creator | VARCHAR(64) | 创建人 |
| rec_create_time | DATETIME | 创建时间 |
| rec_revisor | VARCHAR(64) | 修订人 |
| rec_revise_time | DATETIME | 修订时间 |
| arch_flag | INT(1) | 归档标志:0-已删除,1-正常 |

## 🔌 API接口

### 1. 创建项目心得
- **请求**: `POST /project/insight`
- **请求体**:
  ```json
  {
    "projectId": 1,
    "title": "项目心得标题",
    "summary": "心得摘要",
    "content": "<p>富文本内容</p>",
    "tags": "技术,学习,总结"
  }
  ```

### 2. 获取所有项目心得
- **请求**: `GET /project/insight/list`
- **返回**: 项目心得列表

### 3. 根据项目ID获取心得
- **请求**: `GET /project/insight/project/{projectId}`
- **返回**: 指定项目的心得列表

### 4. 获取心得详情
- **请求**: `GET /project/insight/{id}`
- **返回**: 单个项目心得详情

### 5. 更新项目心得
- **请求**: `PUT /project/insight/{id}`
- **请求体**: 同创建接口

### 6. 删除项目心得
- **请求**: `DELETE /project/insight/{id}`
- **说明**: 逻辑删除，不会真正删除数据

## ✨ 主要特性

1. **富文本编辑器**: 使用Tiptap编辑器，支持格式化文本、表格、图片等
2. **标签管理**: 支持为心得添加多个标签，方便分类和检索
3. **项目关联**: 心得与项目关联，可按项目查看相关心得
4. **搜索筛选**: 支持按关键词搜索和按项目筛选
5. **数据持久化**: 所有数据存储在MySQL数据库中

## 🔍 验证部署

1. 访问 `http://localhost:5173/daily/project-record`
2. 点击"项目心得"卡片
3. 点击"新建心得"按钮
4. 填写表单并保存
5. 检查是否成功保存并显示在列表中

## 📝 注意事项

1. **标签处理**: 
   - 前端：标签存储为字符串数组
   - 后端：标签存储为逗号分隔的字符串
   - 数据转换在前端的 `loadProjectInsights` 函数中处理

2. **富文本内容**: 
   - 内容以HTML格式存储
   - 使用Tiptap编辑器进行编辑

3. **权限控制**: 
   - 所有API都需要JWT认证
   - 用户只能查看和操作自己创建的心得

## 🆘 常见问题

### 问题1: 创建心得后列表不刷新
**解决方案**: 检查浏览器控制台，确认API调用成功，并且 `loadProjectInsights()` 被正确执行

### 问题2: 标签显示异常
**解决方案**: 确保标签在保存时正确转换为逗号分隔的字符串，在加载时正确转换为数组

### 问题3: 富文本内容无法保存
**解决方案**: 检查Tiptap编辑器的 `onUpdate` 回调是否正确更新表单数据

## 📅 版本信息

- **版本**: v1.11.0
- **更新日期**: 2025-10-10
- **更新内容**: 新增项目心得的增删改查功能，集成后端API



