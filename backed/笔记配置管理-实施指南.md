# 笔记配置管理功能实施指南

## 已完成

### ✅ 1. 数据库SQL（100%完成）
- 文件：`backed/src/main/resources/db/km_note_config.sql`
- 已添加所有6种笔记类型的初始化配置数据
  - 碎片笔记：category、theme
  - 学习笔记：subject、course
  - 背诵笔记：subject、category
  - 刷题笔记：subject、source
  - 实战笔记：domain、techStack
  - 框架笔记：category、subject

### ✅ 2. 后端API（100%完成）
- 通用NoteConfig实体、Mapper、Service、Controller已完成
- 支持所有笔记类型的配置管理

### ✅ 3. 前端API封装（100%完成）
- 文件：`fronted/src/api/noteConfig.ts`
- 支持所有笔记类型的配置CRUD操作

### ✅ 4. 学习笔记配置界面（100%完成）
- 文件：`fronted/src/views/materials/StudyNotes.vue`
- 已添加学科(subject)和课程(course)配置管理
- 包含：配置列表、添加、编辑、删除、弹窗

## 待完成

### 📝 2. 背诵笔记 (MemorizationNotes.vue)
需要添加：
- 科目(subject)配置管理
- 分类(category)配置管理

**实施步骤：**
1. 在阅读笔记卡片后添加配置管理UI（参考StudyNotes.vue第99-179行）
2. 在script部分添加导入：
   ```ts
   import { getConfigsByNoteType, createConfig, updateConfig as updateConfigAPI, deleteConfig as deleteConfigAPI, type NoteConfig } from '@/api/noteConfig'
   ```
3. 添加响应式变量：
   ```ts
   const configSubjects = ref<NoteConfig[]>([])
   const configCategories = ref<NoteConfig[]>([])
   const showAddConfigModal = ref(false)
   const currentConfigType = ref<'subject' | 'category'>('subject')
   const newConfigName = ref('')
   ```
4. 添加loadConfigs、openAddConfigModal、addConfig、updateConfig、deleteConfig函数（参考StudyNotes.vue第586-675行）
5. 在onMounted和onActivated中调用loadConfigs()
6. 在template末尾添加弹窗（参考StudyNotes.vue第560-607行）

### 📝 3. 刷题笔记 (ExerciseNotes.vue)
需要添加：
- 学科(subject)配置管理
- 题目来源(source)配置管理

**实施步骤：** 同上，noteType改为'exercise'，配置类型为'subject'和'source'

### 📝 4. 实战笔记 (PracticalNotes.vue)
需要添加：
- 领域(domain)配置管理
- 技术栈(techStack)配置管理

**实施步骤：** 同上，noteType改为'practical'，配置类型为'domain'和'techStack'

### 📝 5. 框架笔记 (FrameworkNotes.vue)
需要添加：
- 分类(category)配置管理
- 学科(subject)配置管理

**实施步骤：** 同上，noteType改为'framework'，配置类型为'category'和'subject'

## 关键代码模板

### UI模板（放在统计卡片之后）
```vue
<!-- XX笔记配置 -->
<div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-8">
  <div class="flex items-center justify-between mb-6">
    <div class="flex items-center space-x-3">
      <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center">
        <i class="fas fa-cog text-white"></i>
      </div>
      <h2 class="text-xl font-semibold text-gray-900">XX笔记配置</h2>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- 第一个配置类型 -->
    <div class="border border-gray-200 rounded-lg p-4">
      <div class="flex items-center justify-between mb-4">
        <h3 class="font-semibold text-gray-800">配置名称1</h3>
        <button 
          @click="openAddConfigModal('type1')"
          class="px-3 py-1.5 bg-blue-500 text-white text-sm rounded-lg hover:bg-blue-600 transition-colors flex items-center space-x-1"
        >
          <i class="fas fa-plus"></i>
          <span>添加</span>
        </button>
      </div>
      <div class="space-y-2 max-h-60 overflow-y-auto">
        <div 
          v-for="item in configType1" 
          :key="item.id"
          class="flex items-center justify-between p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"
        >
          <input 
            type="text" 
            v-model="item.configName"
            @blur="updateConfig(item)"
            class="flex-1 bg-transparent border-none focus:outline-none text-sm"
          />
          <button 
            @click="deleteConfig(item.id!)"
            class="ml-2 text-red-500 hover:text-red-700 text-sm"
          >
            <i class="fas fa-trash-alt"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- 第二个配置类型（同上，修改type1为type2） -->
  </div>
</div>
```

### 脚本模板
```ts
// 配置数据
const configType1 = ref<NoteConfig[]>([])
const configType2 = ref<NoteConfig[]>([])
const showAddConfigModal = ref(false)
const currentConfigType = ref<'type1' | 'type2'>('type1')
const newConfigName = ref('')

// 加载配置
const loadConfigs = async () => {
  try {
    const res = await getConfigsByNoteType('noteTypeHere')
    if (res.code === 200 && res.data) {
      configType1.value = res.data.filter((c: NoteConfig) => c.configType === 'type1')
      configType2.value = res.data.filter((c: NoteConfig) => c.configType === 'type2')
    }
  } catch (error) {
    console.error('加载配置失败:', error)
  }
}

// 其他函数：openAddConfigModal、addConfig、updateConfig、deleteConfig
// （参考StudyNotes.vue第599-675行）
```

## 部署说明

1. 执行SQL脚本（如果还没执行）：
   ```bash
   mysql -u root -p knowledge_management < backed/src/main/resources/db/km_note_config.sql
   ```

2. 重启后端服务

3. 刷新前端浏览器即可使用

## 测试检查清单

- [ ] 学习笔记：学科、课程配置管理正常
- [ ] 背诵笔记：科目、分类配置管理正常
- [ ] 刷题笔记：学科、题目来源配置管理正常
- [ ] 实战笔记：领域、技术栈配置管理正常  
- [ ] 框架笔记：分类、学科配置管理正常
- [ ] 碎片笔记：分类、主题配置管理正常
- [ ] 所有配置独立（用户A的配置不影响用户B）
- [ ] 配置修改后新建笔记时下拉选项更新

## 注意事项

1. 每个笔记类型的`noteType`参数必须正确：
   - 学习笔记：'study'
   - 背诵笔记：'memorization'
   - 刷题笔记：'exercise'
   - 实战笔记：'practical'
   - 框架笔记：'framework'

2. 配置类型`configType`对应SQL中的初始化数据

3. 所有函数都已在StudyNotes.vue中实现，可直接复制并修改参数

4. 弹窗UI完全相同，只需修改配置类型名称


