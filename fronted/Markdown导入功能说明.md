# Markdown 导入功能使用说明

## 📝 功能概述

在笔记记录系统中，所有富文本编辑器现在都支持直接导入 Markdown 文件（`.md` 或 `.markdown`），系统会自动将 Markdown 语法转换为富文本格式。

## 🎯 适用范围

### 支持的编辑器：
1. **主编辑器** - 用于大部分笔记类型（求学笔记、刷题笔记、实战笔记、碎片笔记、框架笔记）
2. **背诵笔记专用编辑器**：
   - 原文内容编辑器
   - 解释说明编辑器
   - 记忆提示词编辑器

## 🚀 使用方法

### 1. 新建笔记时导入
1. 在 `http://localhost:5173/daily/material-record` 页面
2. 选择笔记类型
3. 在富文本编辑器工具栏找到 Markdown 图标（📄）
4. 点击按钮，选择您的 `.md` 文件
5. 系统自动转换并导入内容

### 2. 编辑笔记时导入
1. 点击"管理笔记"
2. 选择要编辑的笔记
3. 在编辑器工具栏点击 Markdown 导入按钮
4. 选择文件即可导入

## ✨ 支持的 Markdown 语法

### 标题（支持 H1-H4）
```markdown
# 一级标题
## 二级标题
### 三级标题
#### 四级标题
```

### 文本样式
```markdown
**粗体文本** 或 __粗体文本__
*斜体文本* 或 _斜体文本_
~~删除线~~
`行内代码`
```

### 代码块（支持语言标识）
````markdown
```javascript
function hello() {
  console.log("Hello World");
}
```

```python
def hello():
    print("Hello World")
```

```sql
SELECT * FROM users WHERE id = 1;
```
````

### 表格（✨ 新增支持）
```markdown
| 字段 | 类型 | 说明 |
|------|------|------|
| id | int | 主键 |
| name | varchar | 用户名 |
| email | varchar | 邮箱 |
```

### 链接和图片
```markdown
[链接文本](https://example.com)
![图片描述](https://example.com/image.jpg)
```
> 💡 链接会自动在新标签页打开

### 列表（支持有序和无序）
```markdown
无序列表：
* 项目1
* 项目2
- 项目3
+ 项目4

有序列表：
1. 第一项
2. 第二项
3. 第三项
```

### 引用
```markdown
> 这是一段引用文本
> 可以多行引用
```

### 分割线（支持多种格式）
```markdown
---
***
___
```

## ⚠️ 注意事项

1. **文件编码**：必须使用 UTF-8 编码的 Markdown 文件（推荐使用 UTF-8 without BOM）
2. **内容覆盖**：导入操作会**完全覆盖**编辑器中的现有内容，请先保存重要内容
3. **表格支持**：支持标准 Markdown 表格格式，会自动转换为 HTML 表格
4. **图片路径**：图片链接必须是有效的 URL 地址或 base64 编码
5. **代码块**：支持语言标识（如 ```javascript），会保留代码格式
6. **特殊字符**：中文、emoji 等特殊字符完全支持

## 🎨 工具栏位置

Markdown 导入按钮（📄 图标）位于：
- 主编辑器：图片上传按钮旁边
- 背诵笔记编辑器：撤销/重做按钮旁边

## 💡 使用建议

1. **备份重要内容**：导入前建议先保存当前内容
2. **预览效果**：导入后检查转换效果，必要时手动调整
3. **分段导入**：对于长文档，可以分段导入以便更好控制格式
4. **模板复用**：可以准备常用的 Markdown 模板文件，快速创建笔记

## 🔧 技术实现

- **无依赖**：本功能使用纯 JavaScript 实现，不依赖外部库
- **轻量级**：Markdown 解析器体积小，加载快速
- **兼容性**：支持所有现代浏览器
- **智能解析**：采用占位符机制，确保代码块和行内代码不被误处理
- **顺序优化**：按照正确的优先级处理各种 Markdown 语法

## 📋 改进历史

### v1.1 - 2025-10-08（当前版本）
**重大改进：**
- ✅ **新增表格支持**：完整支持 Markdown 表格语法
- ✅ **改进代码块处理**：使用占位符机制，避免代码内容被误转换
- ✅ **优化段落识别**：智能识别块级元素，避免重复包裹
- ✅ **修复列表嵌套**：改进列表项的包裹逻辑
- ✅ **增强换行处理**：正确区分段落换行和普通换行
- ✅ **标准化输入**：统一处理不同操作系统的换行符
- ✅ **链接安全**：所有链接自动在新标签页打开

**解决的问题：**
- 修复代码块内容被错误转换的问题
- 修复段落格式错乱的问题
- 修复列表不能正确显示的问题
- 修复标题层级识别错误的问题

### v1.0 - 2025-10-08
- 🎉 初始版本发布
- ✅ 基本 Markdown 语法支持
- ✅ 支持四个编辑器（主编辑器 + 背诵笔记3个编辑器）

## 💡 最佳实践

### 1. 复杂文档的导入建议
对于包含大量代码和表格的复杂文档：
```markdown
1. 先导入到主编辑器
2. 检查代码块是否正确显示
3. 检查表格格式是否正确
4. 必要时手动调整个别元素
```

### 2. 文档模板示例
创建一个标准的笔记模板：
```markdown
# [笔记标题]

## 概述
[简要说明]

## 主要内容

### 知识点1
详细内容...

### 知识点2
详细内容...

## 代码示例
​```javascript
// 代码内容
​```

## 总结
[总结内容]
```

### 3. 导入前检查清单
- [ ] 文件编码是 UTF-8
- [ ] 代码块使用 ``` 包裹
- [ ] 表格格式正确（包含分隔符行）
- [ ] 链接和图片URL有效
- [ ] 已备份当前编辑器内容

## 🐛 已知限制

1. **嵌套列表**：目前仅支持单层列表，复杂的嵌套列表可能需要手动调整
2. **复杂表格**：合并单元格等高级表格特性需要手动编辑
3. **自定义HTML**：Markdown 中的 HTML 标签会被保留，但可能影响显示效果
4. **任务列表**：`- [ ]` 和 `- [x]` 格式暂不支持

## 📞 问题反馈

如遇到以下问题，请反馈：
- 导入后格式完全错乱
- 代码块内容丢失
- 中文或特殊字符乱码
- 表格无法正常显示

---

**版本**：v1.1  
**更新时间**：2025-10-08  
**状态**：✅ 稳定版本  

如有任何问题或建议，欢迎反馈！


