# 求学笔记富文本编辑器更新说明

## 更新日期
2025-10-13

## 功能描述
求学笔记改为多个富文本编辑器，从原来的"标题、摘要、内容"改为：
1. **标题** - 保留原有input输入框
2. **摘要** - 保留原有textarea输入框
3. **核心概念** - 新增富文本编辑器
4. **机制原理** - 新增富文本编辑器
5. **应用案例** - 新增富文本编辑器
6. **延伸/对比** - 新增富文本编辑器
7. **常见误区** - 新增富文本编辑器
8. **思考理解** - 新增富文本编辑器

## 数据库更新

### 执行SQL
请在MySQL数据库中执行以下SQL语句（位于 `backed/src/main/resources/db/update_note_study.sql`）：

```sql
ALTER TABLE `km_note`
ADD COLUMN `core_concept` TEXT COMMENT '核心概念（富文本）' AFTER `study_subject`,
ADD COLUMN `mechanism` TEXT COMMENT '机制原理（富文本）' AFTER `core_concept`,
ADD COLUMN `application_case` TEXT COMMENT '应用案例（富文本）' AFTER `mechanism`,
ADD COLUMN `extension` TEXT COMMENT '延伸/对比（富文本）' AFTER `application_case`,
ADD COLUMN `common_mistake` TEXT COMMENT '常见误区（富文本）' AFTER `extension`,
ADD COLUMN `reflection` TEXT COMMENT '思考理解（富文本）' AFTER `common_mistake`;
```

### 字段说明
- `core_concept`: 核心概念（富文本，TEXT类型）
- `mechanism`: 机制原理（富文本，TEXT类型）
- `application_case`: 应用案例（富文本，TEXT类型）
- `extension`: 延伸/对比（富文本，TEXT类型）
- `common_mistake`: 常见误区（富文本，TEXT类型）
- `reflection`: 思考理解（富文本，TEXT类型）

## 后端更新内容

### 1. Note实体类 (`Note.java`)
添加了六个新字段：
- coreConcept
- mechanism
- applicationCase
- extension
- commonMistake
- reflection

### 2. NoteMapper.xml
更新了以下内容：
- resultMap: 添加六个字段的映射
- Base_Column_List: 添加六个字段到查询列表
- insert语句: 添加六个字段
- update语句: 添加六个字段的动态更新

## 前端更新内容

### 1. MaterialRecord.vue
#### 新增编辑器
- `coreConceptEditor`: 核心概念编辑器
- `mechanismEditor`: 机制原理编辑器
- `applicationCaseEditor`: 应用案例编辑器
- `extensionEditor`: 延伸/对比编辑器
- `commonMistakeEditor`: 常见误区编辑器
- `reflectionEditor`: 思考理解编辑器

所有六个编辑器都配置了完整的增强版工具栏，包括：
- **基础格式**：粗体、斜体、下划线、删除线
- **标题**：H1、H2、H3
- **列表**：无序列表、有序列表
- **对齐**：左对齐、居中、右对齐
- **高亮和代码**：文本高亮、代码块
- **表格和媒体**：插入表格、插入图片、上传图片
- **链接**：插入链接、取消链接
- **撤销重做**：撤销、重做
- **Markdown**：导入Markdown

#### recordForm添加字段
```javascript
coreConcept: '',          // 核心概念（富文本）
mechanism: '',            // 机制原理（富文本）
applicationCase: '',      // 应用案例（富文本）
extension: '',            // 延伸/对比（富文本）
commonMistake: '',        // 常见误区（富文本）
reflection: '',           // 思考理解（富文本）
```

#### 新增辅助函数
```javascript
setStudyLink()          // 插入链接
insertStudyTable()      // 插入表格
insertStudyImage()      // 插入图片
uploadStudyImage()      // 上传图片
undoStudy()            // 撤销
redoStudy()            // 重做
```

#### HTML模板
求学笔记编辑区域改为：
- 标题（input输入框）
- 摘要（textarea输入框）
- 核心概念（富文本编辑器）
- 机制原理（富文本编辑器）
- 应用案例（富文本编辑器）
- 延伸/对比（富文本编辑器）
- 常见误区（富文本编辑器）
- 思考理解（富文本编辑器）

## 使用说明

1. **执行数据库更新脚本**
   ```bash
   cd backed/src/main/resources/db
   mysql -u your_username -p your_database < update_note_study.sql
   ```

2. **重启后端服务**
   - 停止当前运行的Spring Boot应用
   - 重新启动后端服务

3. **前端无需额外操作**
   - 前端代码已更新完成
   - 刷新浏览器即可看到新的六个编辑器界面

## 注意事项

1. **数据兼容性**: 旧的求学笔记数据不会丢失，但新字段为空
2. **编辑器功能**: 六个编辑器都支持基础的富文本编辑功能
3. **数据保存**: 六个编辑器的内容会自动保存到对应的字段中

## 版本信息
- 更新版本: v2.2.0
- 相关功能: 求学笔记多编辑器优化

